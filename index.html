<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login | Mini To-Do Gamer</title>

  <!-- NES.css -->
  <link rel="stylesheet" href="https://unpkg.com/nes.css/css/nes.min.css">
  <link rel="stylesheet" href="css/style.css">

  <!-- Fonte Press Start 2P -->
  <link href="https://fonts.googleapis.com/css?family=Press+Start+2P" rel="stylesheet">
</head>
<body>

<div class="nes-container with-title" style="max-width:400px; margin:auto; margin-top:100px;">
  <h1 class="title">Login</h1>
  <button id="loginBtn" class="nes-btn is-primary">Entrar com Google</button>
</div>

<!-- Script modular -->
<script type="module">
  import { loginWithGoogle, createOrUpdateUser } from './js/firebase.js';

  const loginBtn = document.getElementById('loginBtn');

loginBtn.onclick = async () => {
  try {
    console.log("1. Clicou no bot√£o");

    const user = await loginWithGoogle();
    console.log("2. Login OK:", user.uid);

    localStorage.setItem("userId", user.uid);
    localStorage.setItem("userName", user.displayName);

    console.log("3. Salvou no localStorage");

    await createOrUpdateUser(user.uid, user.displayName);
    console.log("4. createOrUpdateUser OK");

    console.log("5. Redirecionando...");
    window.location.href = "home.html";

  } catch(err) {
    console.error("ERRO:", err);
    alert("Erro ao fazer login: " + err.message);
  }
};

</script>

</body>
</html>
